<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive ML Dashboard v2.0</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="top-nav">
        <div class="segmented-control">
            <div class="seg-slider"></div>
            <button class="seg-btn active" data-mode="regression">Regression</button>
            <button class="seg-btn" data-mode="classification">Classification</button>
            <button class="seg-btn" data-mode="pca">PCA</button>
            <button class="seg-btn" data-mode="kmeans">KMeans</button>
        </div>
    </div>

    <div id="canvas-container">
        <div id="viz">
            <div id="empty-state-prompt">üñ±Ô∏è Click anywhere to add data points</div>
            <div id="metrics-card">
                <span id="metrics-label">R¬≤</span>
                <span id="metrics-value">0.000</span>
            </div>
            <div id="point-tooltip" class="hidden"></div>
            <div id="global-tooltip" class="hidden"></div>
        </div>
    </div>

    <div id="sidebar">
        
        <div id="regression-panel">
            <div class="sidebar-header">
                <h2>Model Settings</h2>
                <button class="btn-reset" onclick="app.resetData()">Reset Data</button>
            </div>

            <div class="control-group">
                <h3>Algorithm</h3>
                <div class="tab-switcher">
                    <div class="tab-slider"></div>
                    <button class="tab-btn active" data-model="ols" data-tooltip="ÊúÄÂ∞èÂπ≥ÊñπÊ≥ïÔºöÈÄüÂ∫¶Âø´„ÄÅÊ®°ÂûãÁ∞°ÂñÆÔºå‰ΩÜÂ∞çÈõ¢Áæ§ÂÄºÊïèÊÑü„ÄÇ">OLS</button>
                    <button class="tab-btn" data-model="absolute" data-tooltip="ÊúÄÂ∞èÁµïÂ∞çÂÅèÂ∑ÆÊ≥ïÔºöÂ∞çÈõ¢Áæ§ÂÄºÊúâËºÉÂ•ΩÁöÑÁ©©ÂÅ•ÊÄß„ÄÇ">LAD</button>
                    <button class="tab-btn" data-model="ridge" data-tooltip="Â∂∫Ëø¥Ê≠∏ (L2 Ê≠£Ë¶èÂåñ)ÔºöÈò≤Ê≠¢Ê®°ÂûãÈÅéÊì¨Âêà„ÄÇ">Ridge</button>
                </div>
                
                <div id="lambda-control-reg" class="slider-container">
                    <label data-tooltip="Ê≠£Ë¶èÂåñÂº∑Â∫¶ÔºöÂÄºË∂äÈ´òÔºåÊ®°ÂûãË∂äÂπ≥Á∑©ÔºåÊúâÂä©ÊñºÈò≤Ê≠¢ÈÅéÊì¨Âêà„ÄÇ">
                        <span>Lambda (Œª)</span>
                        <span id="lambda-val-reg" class="mono-text">1.0</span>
                    </label>
                    <input type="range" id="lambda-input-reg" min="0" max="100" step="1" value="1">
                </div>
            </div>
            
            <div class="control-group accordion collapsed">
                <button class="accordion-header">
                    <span>Advanced Settings</span>
                    <svg class="accordion-arrow" viewBox="0 0 20 20"><path d="M10 13l-6-6h12z"/></svg>
                </button>
                <div class="accordion-content">
                    <div class="input-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                        <label>X Name <input type="text" id="reg-x-name" value="x"></label>
                        <label>Y Name <input type="text" id="reg-y-name" value="y"></label>
                        <label>X Min <input type="number" id="reg-xmin" value="0"></label>
                        <label>X Max <input type="number" id="reg-xmax" value="20"></label>
                        <label>Y Min <input type="number" id="reg-ymin" value="0"></label>
                        <label>Y Max <input type="number" id="reg-ymax" value="20"></label>
                    </div>
                </div>
            </div>
        </div>

        <div id="classification-panel" class="hidden">
            <div class="sidebar-header">
                <h2>Model Settings</h2>
                <button class="btn-reset" onclick="app.resetData()">Reset Data</button>
            </div>

            <div class="control-group">
                <h3>Add Data Point (Class)</h3>
                <div class="class-painter">
                    <button class="paint-btn active" data-class="0" data-tooltip="È°ûÂà• 0 (ÂèØÊåâ 1)">
                        <svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="35"/></svg>
                    </button>
                    <button class="paint-btn" data-class="1" data-tooltip="È°ûÂà• 1 (ÂèØÊåâ 2)">
                        <svg viewBox="0 0 100 100"><rect x="15" y="15" width="70" height="70" rx="10"/></svg>
                    </button>
                </div>
                <div class="class-names">
                    <span id="cls-0-name-label" class="click-to-edit">Class 0</span>
                    <span id="cls-1-name-label" class="click-to-edit">Class 1</span>
                </div>
                <div class="instruction-text">Press <strong>1, 2</strong> to switch quickly</div>
            </div>

            <div class="control-group">
                <h3>Algorithm</h3>
                <div class="tab-switcher">
                    <div class="tab-slider"></div>
                    <button class="tab-btn active" data-model="logistic" data-tooltip="ÈÇèËºØËø¥Ê≠∏ÔºöÂª∫Á´ãÁ∑öÊÄßÊàñÂ§öÈ†ÖÂºèÁöÑÊ±∫Á≠ñÈÇäÁïå„ÄÇ">Logistic</button>
                    <button class="tab-btn" data-model="knn" data-tooltip="K-ÈÑ∞ËøëÊºîÁÆóÊ≥ïÔºöÊ†πÊìöÊúÄËøëÁöÑ K ÂÄãÈÑ∞Â±ÖÈÄ≤Ë°åÂàÜÈ°û„ÄÇ">KNN</button>
                </div>

                <div id="poly-degree-control" class="parameter-control active">
                    <label data-tooltip="Â§öÈ†ÖÂºèÈöéÊï∏ÔºöÂ¢ûÂä†Ê®°ÂûãË§áÈõúÂ∫¶‰ª•Âª∫Á´ãÈùûÁ∑öÊÄßÁöÑÊ±∫Á≠ñÈÇäÁïå„ÄÇ">Poly Degree (Curve)</label>
                    <div class="tab-switcher" id="poly-degree-switcher">
                        <div class="tab-slider"></div>
                        <button class="tab-btn active" data-value="1">1</button>
                        <button class="tab-btn" data-value="2">2</button>
                        <button class="tab-btn" data-value="3">3</button>
                    </div>
                </div>
                <div id="logistic-lambda-control" class="slider-container active">
                     <label data-tooltip="Ê≠£Ë¶èÂåñÂº∑Â∫¶ÔºöÂÄºË∂äÈ´òÔºåÊ®°ÂûãË∂äÂπ≥Á∑©ÔºåÊúâÂä©ÊñºÈò≤Ê≠¢ÈÅéÊì¨Âêà„ÄÇ">
                        <span>Regularization (Œª)</span>
                        <span id="logistic-lambda-val" class="mono-text">0.1</span>
                    </label>
                    <input type="range" id="logistic-lambda-input" min="0" max="5" step="0.1" value="0.1">
                </div>

                <div id="knn-k-control" class="parameter-control">
                    <label data-tooltip="ÈÑ∞Â±ÖÊï∏Èáè (K)ÔºöÊ±∫ÂÆöË¶ÅËÄÉÊÖÆÂ§öÂ∞ëÂÄãÊúÄËøëÁöÑÈÑ∞Â±Ö‰æÜÈÄ≤Ë°åÂàÜÈ°û„ÄÇ">Neighbors (K)</label>
                    <div class="tab-switcher" id="knn-k-switcher">
                        <div class="tab-slider"></div>
                        <button class="tab-btn active" data-value="3">3</button>
                        <button class="tab-btn" data-value="5">5</button>
                        <button class="tab-btn" data-value="7">7</button>
                    </div>
                </div>
            </div>

            <div class="control-group accordion collapsed">
                <button class="accordion-header">
                    <span>Advanced Settings</span>
                    <svg class="accordion-arrow" viewBox="0 0 20 20"><path d="M10 13l-6-6h12z"/></svg>
                </button>
                <div class="accordion-content">
                    <div class="input-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                        <label>X Name <input type="text" id="cls-x-name" value="x1"></label>
                        <label>Y Name <input type="text" id="cls-y-name" value="x2"></label>
                        <label>X Min <input type="number" id="cls-xmin" value="0"></label>
                        <label>X Max <input type="number" id="cls-xmax" value="20"></label>
                        <label>Y Min <input type="number" id="cls-ymin" value="0"></label>
                        <label>Y Max <input type="number" id="cls-ymax" value="20"></label>
                    </div>
                </div>
            </div>
        </div>

        <div id="pca-panel" class="hidden">
            <div class="sidebar-header">
                <h2>Model Settings</h2>
                <button class="btn-reset" onclick="app.resetData()">Reset Data</button>
            </div>
            <div class="control-group">
                <h3>Parameters</h3>
                <div class="instruction-text" style="text-align: left; margin-top: 0;">PCA has no parameters to configure.</div>
            </div>
             <div class="control-group accordion collapsed">
                <button class="accordion-header">
                    <span>Advanced Settings</span>
                    <svg class="accordion-arrow" viewBox="0 0 20 20"><path d="M10 13l-6-6h12z"/></svg>
                </button>
                <div class="accordion-content">
                    <div class="input-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                        <label>X Name <input type="text" id="pca-x-name" value="PC1"></label>
                        <label>Y Name <input type="text" id="pca-y-name" value="PC2"></label>
                        <label>X Min <input type="number" id="pca-xmin" value="-10"></label>
                        <label>X Max <input type="number" id="pca-xmax" value="10"></label>
                        <label>Y Min <input type="number" id="pca-ymin" value="-10"></label>
                        <label>Y Max <input type="number" id="pca-ymax" value="10"></label>
                    </div>
                </div>
            </div>
        </div>

        <div id="kmeans-panel" class="hidden">
            <div class="sidebar-header">
                <h2>Model Settings</h2>
                <button class="btn-reset" onclick="app.resetData()">Reset Data</button>
            </div>

            <div class="control-group">
                <h3>K (Clusters)</h3>
                <button class="btn-reset" id="kmeans-rerun">Re-run (kmeans++)</button>
            </div>

            <div class="control-group">
                <h3>Elbow Method</h3>
                <div id="elbow-chart" class="elbow-chart"></div>
            </div>

            <div class="control-group accordion collapsed">
                <button class="accordion-header">
                    <span>Advanced Settings</span>
                    <svg class="accordion-arrow" viewBox="0 0 20 20"><path d="M10 13l-6-6h12z"/></svg>
                </button>
                <div class="accordion-content">
                    <div class="input-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                        <label>X Name <input type="text" id="kmeans-x-name" value="x"></label>
                        <label>Y Name <input type="text" id="kmeans-y-name" value="y"></label>
                        <label>X Min <input type="number" id="kmeans-xmin" value="0"></label>
                        <label>X Max <input type="number" id="kmeans-xmax" value="20"></label>
                        <label>Y Min <input type="number" id="kmeans-ymin" value="0"></label>
                        <label>Y Max <input type="number" id="kmeans-ymax" value="20"></label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./engine.reg.js"></script>
    <script src="./engine.cls.js"></script>
    <script src="./engine.pca.js"></script>
    <script src="./engine.kmeans.js"></script>
    <script src="./app.js"></script>
    <script src="./main.js"></script>
</body>
</html>
